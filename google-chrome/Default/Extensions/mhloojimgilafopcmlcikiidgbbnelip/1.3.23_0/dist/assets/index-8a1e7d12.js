import{c as e}from"./reactivity.esm-bundler-72867dac.js";import{a as t}from"./position-7d705053.js";import{t as n}from"./error-c58402b8.js";import{g as l}from"./scroll-f7c38f71.js";import{t as o}from"./throttle-c9305476.js";import{v as i}from"./runtime-core.esm-bundler-77b13fca.js";import"./style-ac750348.js";import"./debounce-c2dba7cb.js";import"./_MapCache-31dad113.js";import"./isSymbol-1e3d4c76.js";const r="ElInfiniteScroll",s={delay:{type:Number,default:200},distance:{type:Number,default:0},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},c=(e,t)=>Object.entries(s).reduce(((n,[l,o])=>{var i,r;const{type:s,default:c}=o,a=e.getAttribute(`infinite-scroll-${l}`);let d=null!=(r=null!=(i=t[a])?i:a)?r:c;return d="false"!==d&&d,d=s(d),n[l]=Number.isNaN(d)?c:d,n}),{}),a=e=>{const{observer:t}=e[r];t&&(t.disconnect(),delete e[r].observer)},d=(e,n)=>{const{container:l,containerEl:o,instance:i,observer:s,lastScrollTop:a}=e[r],{disabled:d,distance:u}=c(e,i),{clientHeight:m,scrollHeight:b,scrollTop:p}=o,f=p-a;if(e[r].lastScrollTop=p,s||d||f<0)return;let v=!1;if(l===e)v=b-(m+p)<=u;else{const{clientTop:n,scrollHeight:l}=e;v=p+m>=t(e,o)+n+l-u}v&&n.call(i)};function u(e,t){const{containerEl:n,instance:l}=e[r],{disabled:o}=c(e,l);o||0===n.clientHeight||(n.scrollHeight<=n.clientHeight?t.call(l):a(e))}const m={async mounted(t,s){const{instance:a,value:m}=s;e(m)||n(r,"'v-infinite-scroll' binding value must be a function"),await i();const{delay:b,immediate:p}=c(t,a),f=l(t,!0),v=f===window?document.documentElement:f,y=o(d.bind(null,t,m),b);if(f){if(t[r]={instance:a,container:f,containerEl:v,delay:b,cb:m,onScroll:y,lastScrollTop:v.scrollTop},p){const e=new MutationObserver(o(u.bind(null,t,m),50));t[r].observer=e,e.observe(t,{childList:!0,subtree:!0}),u(t,m)}f.addEventListener("scroll",y)}},unmounted(e){const{container:t,onScroll:n}=e[r];null==t||t.removeEventListener("scroll",n),a(e)},async updated(e){e[r]||await i();const{containerEl:t,cb:n,observer:l}=e[r];t.clientHeight&&l&&u(e,n)},install:e=>{e.directive("InfiniteScroll",m)}},b=m;export{b as ElInfiniteScroll,m as default};
