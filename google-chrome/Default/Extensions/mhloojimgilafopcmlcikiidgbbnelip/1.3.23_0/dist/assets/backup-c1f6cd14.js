import{a as o}from"./index-1d10c3f7.js";import{d as i}from"./dayjs.min-39fed9c4.js";import{a as s}from"./index-98e2e8c6.js";import{a as t}from"./timeFormat-9f457c07.js";/* empty css             */import{E as e}from"./el-upload-4924c960.js";import"./el-progress-06a69d44.js";/* empty css                    *//* empty css                          *//* empty css                  *//* empty css                   */import{E as r}from"./el-dialog-9345927c.js";/* empty css                   *//* empty css                   */import{u as m}from"./main-f5b07798.js";import{c as a}from"./create_login-d2de9054.js";import{A as p,w as l}from"./public-api-84c5ab9b.js";import{isEmptyObject as n}from"./utils-73d66301.js";import{SAVE_CONFIG as j}from"./save_config-35e78de8.js";import c from"./hisBackup-1b009a47.js";import{l as d}from"./local-82fd2aea.js";import{u}from"./baseRequest-a74f719c.js";import{_ as b}from"./_plugin-vue_export-helper-1b428a4d.js";import{ElButton as f}from"./index-40ae5b07.js";import{a as x,E as k}from"./index-b42e10cf.js";import{ElLoading as g}from"./index-be62862f.js";import{ElMessage as v}from"./index-da9a90a7.js";import{b as h,u as y,t as _}from"./reactivity.esm-bundler-72867dac.js";import{o as C,a as V,b as w,e as T,f as A,l as Y,h as E,j as D,F,m as H,p as q,i as M}from"./runtime-core.esm-bundler-77b13fca.js";import"./_commonjsHelpers-e5557959.js";import"./axios-a986ab8c.js";import"./preload-helper-706a0e5c.js";import"./version-62e2ec50.js";import"./runtime-dom.esm-bundler-8f945973.js";import"./index-f72b3ea9.js";import"./index-08eda97d.js";import"./_MapCache-31dad113.js";import"./isSymbol-1e3d4c76.js";import"./style-ac750348.js";import"./index-4f6840b9.js";import"./error-c58402b8.js";import"./focus-trap-a7ebc7ce.js";import"./aria-60e0cdc6.js";import"./typescript-5028724d.js";import"./index-11ecaac6.js";import"./index-62715ce7.js";import"./index-854ce82e.js";import"./icon-b1cf815e.js";import"./index-e1484003.js";import"./index-9f7efeb4.js";import"./scroll-f7c38f71.js";import"./d-text-icon-0c972c3a.js";import"./_baseClone-93129bef.js";import"./globStorageState-d3feed6a.js";import"./index-ea316b3a.js";import"./browser-c7a4f02b.js";import"./week-7975c4f4.js";import"./vue.runtime.esm-bundler-07884c49.js";import"./global-3c385e89.js";import"./Plus-9ce421bd.js";import"./Check-63155ac6.js";import"./icon-a5a7f81d.js";import"./icon-fdb117a5.js";import"./d-calendar-9992ce38.js";import"./icon-92d26b08.js";import"./dateTime-73945ad3.js";import"./icon-0ad693e8.js";import"./dateTools-6203f8f7.js";import"./icon-e7ca50f5.js";import"./icon2-d4bc0c65.js";import"./icon3-aa79709d.js";import"./icon-73c56842.js";import"./icon-9c80e3eb.js";import"./icon-c3851054.js";import"./icon-8d5583fa.js";import"./icon-cc372385.js";import"./icon-c1c85589.js";import"./icon-5996535b.js";import"./icon-c531cb5b.js";import"./icon-e1d7edae.js";import"./notes-a9d23bdb.js";import"./icon-2b215e9e.js";import"./icon-eca13f38.js";import"./icon-51af1d1d.js";import"./stocks-0eb3a6ed.js";import"./icon-133d69b9.js";import"./icon-dd45f250.js";import"./icon-d391b03b.js";import"./todo-998e5e96.js";import"./icon-60032c73.js";import"./icon-a65bc46c.js";import"./icon-0ba8aff4.js";import"./icon-6322d102.js";import"./icon-1216e893.js";import"./icon-4fbf9766.js";/* empty css                 *//* empty css                  */import"./icon-3f2dfd1c.js";import"./icon-449c1bca.js";import"./icon-7d2de9c9.js";import"./index-786e6b18.js";import"./el-form-item-538254d8.js";import"./el-radio-99792f58.js";import"./index-2e34e30b.js";import"./d-button-00457c8f.js";import"./index-e52000c7.js";import"./index-de1201fd.js";/* empty css                        *//* empty css                       */import"./Refresh-60fd7e4b.js";import"./index-2a5711a9.js";/* empty css                */import"./Close-20719dd3.js";import"./index-ff2d0a55.js";import"./throttle-c9305476.js";import"./debounce-c2dba7cb.js";import"./position-7d705053.js";import"./index-fb7d3c00.js";import"./validator-c5991710.js";import"./website-234d9ff3.js";import"./indexdb-76ab5eed.js";import"./localforage-5beca937.js";import"./_commonjs-dynamic-modules-3e972b61.js";import"./config-provider-6b9f90d0.js";import"./d-tabs-x-3e76ff84.js";import"./isEqual-13dbd678.js";import"./_baseIsEqual-f45591d3.js";import"./hasIn-68e1becf.js";import"./flatten-86d5e527.js";import"./_baseFlatten-db7d3a92.js";import"./_overRest-675ccd63.js";import"./identity-4a5ba4c0.js";const z=o=>(q("data-v-9451fff9"),o=o(),M(),o),I=[z((()=>w("a",{class:"link"},"同步到本地",-1)))],S={key:0,class:"setting-li-sub"},B={class:"setting-panel"},R=[z((()=>w("a",{class:"link"},"立即备份",-1)))],G=[z((()=>w("a",{class:"link"},"管理历史备份",-1)))],N=z((()=>w("br",null,null,-1))),O={class:"setting-panel"},U=[z((()=>w("a",{class:"link"},"导出备份数据",-1)))],J=z((()=>w("a",{class:"link"},"导入备份数据",-1))),$={class:"p20 ac"},K={class:"ac mb20"},L=b({__name:"backup",setup(b){const q=u();m();const M=[{label:"设置",value:"baseConfig"},{label:"图标",value:"navConfig"},{label:"备忘录",value:"notes"},{label:"待办",value:"todo"}];function z(){L.backupVisible=!0}const L=h({backupVisible:!1,exportVisible:!1,exportCheck:["baseConfig","navConfig","notes","todo"]});function P(o){if(!function(){let o=d.get("token");return o||(a("login"),v.warning("请登录后使用同步功能")),!!o}())return;const i=g.service({lock:!0,text:"数据同步中",background:"rgba(0, 0, 0, 0.7)"});setTimeout((()=>{i.close()}),500),"backup"==o?j(null,100,"manua"):s.userInfo({from:"itab",t:(new Date).getTime()}).then((o=>{q.value=o.data||{};let i=d.get("asyncTime"),s={};for(let t in o.data.itabAsyncTime)i[t]!=o.data.itabAsyncTime[t]&&(s[t]=1);n(s)&&(s=null),p(s,o.data.itabAsyncTime)}))}const Q=o=>{var i=new FileReader;i.readAsText(o.raw),i.onload=()=>{const o=JSON.parse(i.result);o?(l(o),v.success("恢复成功")):v.error("数据格式可能不正确")}},W=()=>{let s={};L.exportCheck.forEach((o=>{s[o]=d.get(o)||[]})),o(JSON.stringify(s),i().format("-YYYY-MM-DD")+".itabdata")};return(o,i)=>(C(),V("span",null,[w("p",{class:"setting-panel lh24 mb20",onClick:i[0]||(i[0]=o=>P("async"))},I),y(q).itabAsyncTime?(C(),V("h2",S," 上次备份: "+_(y(t)(y(q).itabAsyncTime.baseConfig,"YYYY-MM-DD HH:mm:ss")),1)):T("",!0),w("div",B,[w("p",{onClick:i[1]||(i[1]=o=>P("backup"))},R),w("p",{onClick:z},G)]),N,w("div",O,[w("p",{onClick:i[2]||(i[2]=o=>L.exportVisible=!0)},U),A(y(e),{action:"/","show-file-list":!1,multiple:!1,"auto-upload":!1,"on-change":Q,class:"backup-import"},{default:Y((()=>[J])),_:1})]),L.backupVisible?(C(),E(c,{key:1,modelValue:L.backupVisible,"onUpdate:modelValue":i[3]||(i[3]=o=>L.backupVisible=o)},null,8,["modelValue"])):T("",!0),A(y(r),{modelValue:L.exportVisible,"onUpdate:modelValue":i[6]||(i[6]=o=>L.exportVisible=o),title:"选择导出内容",width:"600px"},{footer:Y((()=>[w("div",K,[A(y(f),{size:"default",onClick:i[5]||(i[5]=o=>L.exportVisible=!1)},{default:Y((()=>[D("取消")])),_:1}),A(y(f),{size:"default",class:"ml10",type:"primary",onClick:W},{default:Y((()=>[D("导出")])),_:1})])])),default:Y((()=>[w("div",$,[A(y(x),{modelValue:L.exportCheck,"onUpdate:modelValue":i[4]||(i[4]=o=>L.exportCheck=o)},{default:Y((()=>[(C(),V(F,null,H(M,(o=>A(y(k),{key:o.value,label:o.value},{default:Y((()=>[D(_(o.label),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-9451fff9"]]);export{L as default};
