import{b as s}from"./runtime-dom.esm-bundler-8f945973.js";import{b as i}from"./baseRequest-a74f719c.js";import{D as o}from"./d-tabs-x-3e76ff84.js";import{a as t}from"./timeFormat-9f457c07.js";import{w as e}from"./public-api-84c5ab9b.js";/* empty css             *//* empty css                       *//* empty css                  *//* empty css                 *//* empty css                   *//* empty css                   */import{E as r}from"./el-dialog-9345927c.js";/* empty css                   *//* empty css                */import{SAVE_CONFIG as m}from"./save_config-35e78de8.js";import{l as a}from"./local-82fd2aea.js";import n from"./indexdb-76ab5eed.js";import{E as p}from"./index-f72b3ea9.js";import{q as l,o as c,h as j,f as d,l as u,b as f,g as b,j as v,a as g,e as x,F as h,m as y,a6 as k}from"./runtime-core.esm-bundler-77b13fca.js";import{f as w}from"./main-f5b07798.js";import{E as C}from"./index-fb7d3c00.js";import{ElMessage as H}from"./index-da9a90a7.js";import{ElLoading as _}from"./index-be62862f.js";import{r as Y,t as D,u as M,v as T}from"./reactivity.esm-bundler-72867dac.js";import"./preload-helper-706a0e5c.js";import"./index-ea316b3a.js";import"./axios-a986ab8c.js";import"./version-62e2ec50.js";import"./dayjs.min-39fed9c4.js";import"./_commonjsHelpers-e5557959.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./index-98e2e8c6.js";import"./website-234d9ff3.js";import"./utils-73d66301.js";import"./index-2a5711a9.js";import"./Check-63155ac6.js";import"./Close-20719dd3.js";import"./globStorageState-d3feed6a.js";import"./notes-a9d23bdb.js";import"./todo-998e5e96.js";import"./stocks-0eb3a6ed.js";import"./index-08eda97d.js";import"./_MapCache-31dad113.js";import"./isSymbol-1e3d4c76.js";import"./icon-b1cf815e.js";import"./index-4f6840b9.js";import"./index-11ecaac6.js";import"./focus-trap-a7ebc7ce.js";import"./aria-60e0cdc6.js";import"./style-ac750348.js";import"./index-e1484003.js";import"./index-9f7efeb4.js";import"./error-c58402b8.js";import"./scroll-f7c38f71.js";import"./debounce-c2dba7cb.js";import"./localforage-5beca937.js";import"./_commonjs-dynamic-modules-3e972b61.js";import"./d-text-icon-0c972c3a.js";import"./_baseClone-93129bef.js";import"./browser-c7a4f02b.js";import"./week-7975c4f4.js";import"./vue.runtime.esm-bundler-07884c49.js";import"./global-3c385e89.js";import"./Plus-9ce421bd.js";import"./icon-a5a7f81d.js";import"./icon-fdb117a5.js";import"./d-calendar-9992ce38.js";import"./icon-92d26b08.js";import"./dateTime-73945ad3.js";import"./icon-0ad693e8.js";import"./dateTools-6203f8f7.js";import"./icon-e7ca50f5.js";import"./icon2-d4bc0c65.js";import"./icon3-aa79709d.js";import"./icon-73c56842.js";import"./icon-9c80e3eb.js";import"./icon-c3851054.js";import"./icon-8d5583fa.js";import"./icon-cc372385.js";import"./icon-c1c85589.js";import"./icon-5996535b.js";import"./icon-c531cb5b.js";import"./icon-e1d7edae.js";import"./icon-2b215e9e.js";import"./icon-eca13f38.js";import"./icon-51af1d1d.js";import"./icon-133d69b9.js";import"./icon-dd45f250.js";import"./icon-d391b03b.js";import"./icon-60032c73.js";import"./icon-a65bc46c.js";import"./icon-0ba8aff4.js";import"./icon-6322d102.js";import"./icon-1216e893.js";import"./icon-4fbf9766.js";/* empty css                  */import"./icon-3f2dfd1c.js";import"./icon-449c1bca.js";import"./icon-7d2de9c9.js";import"./index-40ae5b07.js";import"./index-2e34e30b.js";import"./index-62715ce7.js";import"./index-e52000c7.js";import"./index-854ce82e.js";import"./typescript-5028724d.js";import"./index-de1201fd.js";import"./validator-c5991710.js";import"./config-provider-6b9f90d0.js";var z=l({name:"UploadFilled"});const E={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},F=d("path",{fill:"currentColor",d:"M544 864V672h128L512 480 352 672h128v192H320v-1.6c-5.376.32-10.496 1.6-16 1.6A240 240 0 0 1 64 624c0-123.136 93.12-223.488 212.608-237.248A239.808 239.808 0 0 1 512 192a239.872 239.872 0 0 1 235.456 194.752c119.488 13.76 212.48 114.112 212.48 237.248a240 240 0 0 1-240 240c-5.376 0-10.56-1.28-16-1.6v1.6H544z"},null,-1);z.render=function(s,i,o,t,e,r){return c(),j("svg",E,[F])},z.__file="packages/components/UploadFilled.vue";const A=z,B=f("div",{class:"ac f18 b mb10"},"历史备份节点列表",-1),q=f("p",{class:"f12 d-sub ac mb20 pr20 pl20"},[v(" 我们为您保留云端和本机各5个备份节点，云端历史备份需要登陆后手动备份 "),f("br"),v(" 数据修复请联系开发者微信：xdlumia ")],-1),V={class:"p50 al f12",style:{"padding-top":"10px"}},S={class:"d-flex-between mt15"},U={class:"d-sub"},G={class:"d-flex-x mt10"},L={class:"mt20 mb10"},$=f("h2",{class:"d-main f16 b"},"云端历史备份节点",-1),I={key:0,class:"d-sub"},K={class:"history-list"},N={class:"d-sub"},O=["onClick"],P={class:"mr5 d-icon f14",style:{"vertical-align":"-3px"}},R={key:0,class:"ac d-sub"},Z=f("div",{class:"mt20 mb10"},[f("h2",{class:"d-main f16 b"},"本机历史备份节点"),f("p",{class:"d-sub"},"此历史列表备份只包含本机历史备份的图标列表")],-1),J={class:"history-list"},Q={class:"d-sub"},W=["onClick"],X={class:"mr5 d-icon f14",style:{"vertical-align":"-3px"}},ss={key:0,class:"ac d-sub"},is={__name:"hisBackup",setup(l){const z=Y([]),E=Y(null),F=Y([]),is=Y("cloud");function os(s){"cloud"==s.id?ts():es()}function ts(){rs()&&(((s={})=>i.get("/itab/userConfigHistory/list",{params:s}))({size:10}).then((s=>{z.value=s.data||[]})),((s={})=>i.get("/itab/config",{params:s}))({updateTime:1}).then((s=>{E.value=s.data.updateTime})))}function es(){n.get("configHistory").then((s=>{F.value=s||[]}))}function rs(){return!!a.get("token")}function ms(s){C.confirm("此操作将会覆盖本地数据, 是否继续?","恢复数据",{center:!0,type:"warning"}).then((()=>{const o=_.service({lock:!0,text:"恢复备份节点",background:"rgba(0, 0, 0, 0.7)"});((s={})=>i.get("/itab/userConfigHistory/info",{params:s}))({_id:s}).then((s=>{let i=s.data;e(i),o.close(),H({showClose:!0,message:"恢复成功",type:"success"})}))}))}return ts(),es(),(i,a)=>(c(),j(M(r),k({class:"notion-dialog","close-on-press-escape":!1,width:"640px","append-to-body":""},i.$attrs),{default:u((()=>[B,q,f("div",V,[b(f("li",S,[f("span",U,"上次备份时间："+D(M(t)(E.value,"YYYY年MM月DD日 HH:mm:ss")),1),f("span",{onClick:a[0]||(a[0]=s=>{C.confirm("将本地数据备份到云端?","备份数据",{center:!0,type:"warning"}).then((()=>{m(null,100,"manua"),setTimeout((()=>{ts()}),200)}))}),class:"d-pointer d-main"},[d(M(p),{size:14,style:{"vertical-align":"-3px","margin-right":"4px"}},{default:u((()=>[d(M(A))])),_:1}),v("立即备份 ")])],512),[[s,rs()]]),f("div",G,[d(o,{modelValue:is.value,"onUpdate:modelValue":a[1]||(a[1]=s=>is.value=s),onTabClick:os,data:[{name:"云端历史备份",id:"cloud"},{name:"本机历史备份",id:"local"}]},null,8,["modelValue"])]),b(f("div",null,[f("div",L,[$,rs()?x("",!0):(c(),g("p",I," 此功能需要登陆使用，登录后可以查看多设备之间历史节点 "))]),f("ul",K,[(c(!0),g(h,null,y(z.value,(s=>(c(),g("li",{class:"d-flex-between mt20",key:s},[f("span",N,D(M(t)(s.createTime,"YYYY年MM月DD日 HH:mm:ss")),1),f("span",{class:"d-main d-pointer d-hover",onClick:i=>ms(s._id)},[f("i",P,[d(M(w))]),v("从此节点恢复 ")],8,O)])))),128)),z.value.length?x("",!0):(c(),g("p",R,"暂无历史节点备份"))])],512),[[s,"cloud"===is.value]]),b(f("div",null,[Z,f("ul",J,[(c(!0),g(h,null,y(F.value,(s=>(c(),g("li",{class:"d-flex-between mt20",key:s},[f("span",Q,D(M(t)(s.ct,"YYYY年MM月DD日 HH:mm:ss")),1),f("span",{class:"d-main d-pointer d-hover",onClick:i=>{return o=s.ct,void C.confirm("此操作将会覆盖本地数据, 是否继续?","恢复数据",{center:!0,type:"warning"}).then((()=>{let s=F.value.find((s=>s.ct===o));e(T(s.data)),H({showClose:!0,message:"恢复成功",type:"success"})}));var o}},[f("i",X,[d(M(w))]),v("从此节点恢复 ")],8,W)])))),128)),F.value.length?x("",!0):(c(),g("p",ss,"暂无历史节点备份"))])],512),[[s,"local"===is.value]])])])),_:1},16))}};export{is as default};
