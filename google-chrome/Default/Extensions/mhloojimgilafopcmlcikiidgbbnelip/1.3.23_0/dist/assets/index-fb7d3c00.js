import{a as e,w as t,b as n,d as o,r as a}from"./runtime-dom.esm-bundler-8f945973.js";import{ElButton as s}from"./index-40ae5b07.js";import{E as l}from"./index-e52000c7.js";import{a as r,u as i,b as c,c as u}from"./el-dialog-9345927c.js";import{E as d,_ as p}from"./index-f72b3ea9.js";import{E as f}from"./aria-60e0cdc6.js";import{w as m,v,q as g,c as b,t as y,a9 as h,K as C,o as x,h as E,l as w,g as B,f as k,b as T,a as M,r as I,e as j,x as A,j as S,a4 as R}from"./runtime-core.esm-bundler-77b13fca.js";import{E as _}from"./focus-trap-a7ebc7ce.js";import{a as P,T as z}from"./icon-b1cf815e.js";import{i as L}from"./validator-c5991710.js";import{u as V}from"./index-11ecaac6.js";import{u as $}from"./index-08eda97d.js";import{u as O}from"./index-e1484003.js";import{u as H}from"./index-9f7efeb4.js";import{u as q}from"./index-62715ce7.js";import{i as K,r as D,b as U,aa as F,a as N,n as Z,t as W,d as X,V as G,g as J,c as Q}from"./reactivity.esm-bundler-72867dac.js";import{b as Y,d as ee,l as te}from"./style-ac750348.js";const ne=e=>Array.from(e.querySelectorAll('a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])')).filter((e=>oe(e)&&(e=>"fixed"!==getComputedStyle(e).position&&null!==e.offsetParent)(e))),oe=e=>{if(e.tabIndex>0||0===e.tabIndex&&null!==e.getAttribute("tabIndex"))return!0;if(e.disabled)return!1;switch(e.nodeName){case"A":return!!e.href&&"ignore"!==e.rel;case"INPUT":return!("hidden"===e.type||"file"===e.type);case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},ae="_trap-focus-children",se=[],le=e=>{if(0===se.length)return;const t=se[se.length-1][ae];if(t.length>0&&e.code===f.tab){if(1===t.length)return e.preventDefault(),void(document.activeElement!==t[0]&&t[0].focus());const n=e.shiftKey,o=e.target===t[0],a=e.target===t[t.length-1];o&&n&&(e.preventDefault(),t[t.length-1].focus()),a&&!n&&(e.preventDefault(),t[0].focus())}},re=g({name:"ElMessageBox",directives:{TrapFocus:{beforeMount(e){e[ae]=ne(e),se.push(e),se.length<=1&&document.addEventListener("keydown",le)},updated(e){v((()=>{e[ae]=ne(e)}))},unmounted(){se.shift(),0===se.length&&document.removeEventListener("keydown",le)}}},components:{ElButton:s,ElFocusTrap:_,ElInput:l,ElOverlay:r,ElIcon:d,...P},inheritAttrs:!1,props:{buttonSize:{type:String,validator:L},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{t:n}=V(),o=$("message-box"),a=D(!1),{nextZIndex:s}=O(),l=U({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:s()}),r=b((()=>{const e=l.type;return{[o.bm("icon",e)]:e&&z[e]}})),d=H(),p=H(),f=q(b((()=>e.buttonSize)),{prop:!0,form:!0,formItem:!0}),g=b((()=>l.icon||z[l.type]||"")),C=b((()=>!!l.message)),x=D(),E=D(),w=D(),B=D(),k=D(),T=b((()=>l.confirmButtonClass));m((()=>l.inputValue),(async t=>{await v(),"prompt"===e.boxType&&null!==t&&R()}),{immediate:!0}),m((()=>a.value),(t=>{var n,o;t&&("prompt"!==e.boxType&&(l.autofocus?w.value=null!=(o=null==(n=k.value)?void 0:n.$el)?o:x.value:w.value=x.value),l.zIndex=s()),"prompt"===e.boxType&&(t?v().then((()=>{var e;B.value&&B.value.$el&&(l.autofocus?w.value=null!=(e=_())?e:x.value:w.value=x.value)})):(l.editorErrorMessage="",l.validateError=!1))}));const M=b((()=>e.draggable));function I(){a.value&&(a.value=!1,v((()=>{l.action&&t("action",l.action)})))}i(x,E,M),y((async()=>{await v(),e.closeOnHashChange&&window.addEventListener("hashchange",I)})),h((()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",I)}));const j=()=>{e.closeOnClickModal&&S(l.distinguishCancelAndClose?"close":"cancel")},A=u(j),S=t=>{var n;("prompt"!==e.boxType||"confirm"!==t||R())&&(l.action=t,l.beforeClose?null==(n=l.beforeClose)||n.call(l,t,l,I):I())},R=()=>{if("prompt"===e.boxType){const e=l.inputPattern;if(e&&!e.test(l.inputValue||""))return l.editorErrorMessage=l.inputErrorMessage||n("el.messagebox.error"),l.validateError=!0,!1;const t=l.inputValidator;if("function"==typeof t){const e=t(l.inputValue);if(!1===e)return l.editorErrorMessage=l.inputErrorMessage||n("el.messagebox.error"),l.validateError=!0,!1;if("string"==typeof e)return l.editorErrorMessage=e,l.validateError=!0,!1}}return l.editorErrorMessage="",l.validateError=!1,!0},_=()=>{const e=B.value.$refs;return e.input||e.textarea},P=()=>{S("close")};return e.lockScroll&&c(a),((e,t)=>{let n;m((()=>e.value),(e=>{var o,a;e?(n=document.activeElement,K(t)&&(null==(a=(o=t.value).focus)||a.call(o))):n.focus()}))})(a),{...F(l),ns:o,overlayEvent:A,visible:a,hasMessage:C,typeClass:r,contentId:d,inputId:p,btnSize:f,iconComponent:g,confirmButtonClasses:T,rootRef:x,focusStartRef:w,headerRef:E,inputRef:B,confirmRef:k,doClose:I,handleClose:P,onCloseRequested:()=>{e.closeOnPressEscape&&P()},handleWrapperClick:j,handleInputEnter:e=>{if("textarea"!==l.inputType)return e.preventDefault(),S("confirm")},handleAction:S,t:n}}}),ie=["aria-label","aria-describedby"],ce=["aria-label"],ue=["id"];var de=p(re,[["render",function(a,s,l,r,i,c){const u=C("el-icon"),d=C("close"),p=C("el-input"),f=C("el-button"),m=C("el-focus-trap"),v=C("el-overlay");return x(),E(o,{name:"fade-in-linear",onAfterLeave:s[11]||(s[11]=e=>a.$emit("vanish")),persisted:""},{default:w((()=>[B(k(v,{"z-index":a.zIndex,"overlay-class":[a.ns.is("message-box"),a.modalClass],mask:a.modal},{default:w((()=>[T("div",{role:"dialog","aria-label":a.title,"aria-modal":"true","aria-describedby":a.showInput?void 0:a.contentId,class:N(`${a.ns.namespace.value}-overlay-message-box`),onClick:s[8]||(s[8]=(...e)=>a.overlayEvent.onClick&&a.overlayEvent.onClick(...e)),onMousedown:s[9]||(s[9]=(...e)=>a.overlayEvent.onMousedown&&a.overlayEvent.onMousedown(...e)),onMouseup:s[10]||(s[10]=(...e)=>a.overlayEvent.onMouseup&&a.overlayEvent.onMouseup(...e))},[k(m,{loop:"",trapped:a.visible,"focus-trap-el":a.rootRef,"focus-start-el":a.focusStartRef,onReleaseRequested:a.onCloseRequested},{default:w((()=>[T("div",{ref:"rootRef",class:N([a.ns.b(),a.customClass,a.ns.is("draggable",a.draggable),{[a.ns.m("center")]:a.center}]),style:Z(a.customStyle),tabindex:"-1",onClick:s[7]||(s[7]=e((()=>{}),["stop"]))},[null!==a.title&&void 0!==a.title?(x(),M("div",{key:0,ref:"headerRef",class:N(a.ns.e("header"))},[T("div",{class:N(a.ns.e("title"))},[a.iconComponent&&a.center?(x(),E(u,{key:0,class:N([a.ns.e("status"),a.typeClass])},{default:w((()=>[(x(),E(I(a.iconComponent)))])),_:1},8,["class"])):j("v-if",!0),T("span",null,W(a.title),1)],2),a.showClose?(x(),M("button",{key:0,type:"button",class:N(a.ns.e("headerbtn")),"aria-label":a.t("el.messagebox.close"),onClick:s[0]||(s[0]=e=>a.handleAction(a.distinguishCancelAndClose?"close":"cancel")),onKeydown:s[1]||(s[1]=t(e((e=>a.handleAction(a.distinguishCancelAndClose?"close":"cancel")),["prevent"]),["enter"]))},[k(u,{class:N(a.ns.e("close"))},{default:w((()=>[k(d)])),_:1},8,["class"])],42,ce)):j("v-if",!0)],2)):j("v-if",!0),T("div",{id:a.contentId,class:N(a.ns.e("content"))},[T("div",{class:N(a.ns.e("container"))},[a.iconComponent&&!a.center&&a.hasMessage?(x(),E(u,{key:0,class:N([a.ns.e("status"),a.typeClass])},{default:w((()=>[(x(),E(I(a.iconComponent)))])),_:1},8,["class"])):j("v-if",!0),a.hasMessage?(x(),M("div",{key:1,class:N(a.ns.e("message"))},[A(a.$slots,"default",{},(()=>[a.dangerouslyUseHTMLString?(x(),E(I(a.showInput?"label":"p"),{key:1,for:a.showInput?a.inputId:void 0,innerHTML:a.message},null,8,["for","innerHTML"])):(x(),E(I(a.showInput?"label":"p"),{key:0,for:a.showInput?a.inputId:void 0},{default:w((()=>[S(W(a.dangerouslyUseHTMLString?"":a.message),1)])),_:1},8,["for"]))]))],2)):j("v-if",!0)],2),B(T("div",{class:N(a.ns.e("input"))},[k(p,{id:a.inputId,ref:"inputRef",modelValue:a.inputValue,"onUpdate:modelValue":s[2]||(s[2]=e=>a.inputValue=e),type:a.inputType,placeholder:a.inputPlaceholder,"aria-invalid":a.validateError,class:N({invalid:a.validateError}),onKeydown:t(a.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),T("div",{class:N(a.ns.e("errormsg")),style:Z({visibility:a.editorErrorMessage?"visible":"hidden"})},W(a.editorErrorMessage),7)],2),[[n,a.showInput]])],10,ue),T("div",{class:N(a.ns.e("btns"))},[a.showCancelButton?(x(),E(f,{key:0,loading:a.cancelButtonLoading,class:N([a.cancelButtonClass]),round:a.roundButton,size:a.btnSize,onClick:s[3]||(s[3]=e=>a.handleAction("cancel")),onKeydown:s[4]||(s[4]=t(e((e=>a.handleAction("cancel")),["prevent"]),["enter"]))},{default:w((()=>[S(W(a.cancelButtonText||a.t("el.messagebox.cancel")),1)])),_:1},8,["loading","class","round","size"])):j("v-if",!0),B(k(f,{ref:"confirmRef",type:"primary",loading:a.confirmButtonLoading,class:N([a.confirmButtonClasses]),round:a.roundButton,disabled:a.confirmButtonDisabled,size:a.btnSize,onClick:s[5]||(s[5]=e=>a.handleAction("confirm")),onKeydown:s[6]||(s[6]=t(e((e=>a.handleAction("confirm")),["prevent"]),["enter"]))},{default:w((()=>[S(W(a.confirmButtonText||a.t("el.messagebox.confirm")),1)])),_:1},8,["loading","class","round","disabled","size"]),[[n,a.showConfirmButton]])],2)],6)])),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,ie)])),_:3},8,["z-index","overlay-class","mask"]),[[n,a.visible]])])),_:3})}],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const pe=new Map,fe=(e,t,n=null)=>{const o=k(de,e,Q(e.message)||R(e.message)?{default:Q(e.message)?e.message:()=>e.message}:null);return o.appContext=n,a(o,t),(e=>{let t=document.body;return e.appendTo&&(X(e.appendTo)&&(t=document.querySelector(e.appendTo)),te(e.appendTo)&&(t=e.appendTo),te(t)||(t=document.body)),t})(e).appendChild(t.firstElementChild),o.component},me=(e,t)=>{const n=document.createElement("div");e.onVanish=()=>{a(null,n),pe.delete(s)},e.onAction=t=>{const n=pe.get(s);let a;a=e.showInput?{value:s.inputValue,action:t}:t,e.callback?e.callback(a,o.proxy):"cancel"===t||"close"===t?e.distinguishCancelAndClose&&"cancel"!==t?n.reject("close"):n.reject("cancel"):n.resolve(a)};const o=fe(e,n,t),s=o.proxy;for(const a in e)G(e,a)&&!G(s.$props,a)&&(s[a]=e[a]);return s.visible=!0,s};function ve(e,t=null){if(!Y)return Promise.reject();let n;return X(e)||R(e)?e={message:e}:n=e.callback,new Promise(((o,a)=>{const s=me(e,null!=t?t:ve._context);pe.set(s,{options:e,callback:n,resolve:o,reject:a})}))}const ge={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};["alert","confirm","prompt"].forEach((e=>{ve[e]=function(e){return(t,n,o,a)=>{let s="";return J(n)?(o=n,s=""):s=ee(n)?"":n,ve(Object.assign({title:s,message:t,type:"",...ge[e]},o,{boxType:e}),a)}}(e)})),ve.close=()=>{pe.forEach(((e,t)=>{t.doClose()})),pe.clear()},ve._context=null;const be=ve;be.install=e=>{be._context=e._context,e.config.globalProperties.$msgbox=be,e.config.globalProperties.$messageBox=be,e.config.globalProperties.$alert=be.alert,e.config.globalProperties.$confirm=be.confirm,e.config.globalProperties.$prompt=be.prompt};const ye=be;export{ye as E};
